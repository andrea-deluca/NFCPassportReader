<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Secure Session  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>

    <a name="//apple_ref/swift/Section/Secure Session" class="dashAnchor"></a>

    <a title="Secure Session  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
           Docs
        </a>
         (100% documented)
      </p>
    
      <div class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </div>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/andrea-deluca/NFCPassportReader">
            <img class="header-icon" src="img/gh.png" alt="GitHub"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html"> Reference</a>
      <img class="carat" src="img/carat.png" alt=""/>
      Secure Session  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Documentation.html">Documentation</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation.html">Installation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="getting-started.html">Getting Started</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="demo.html">Demo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="get-in-touch.html">Get In Touch</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="credits.html">Credits</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="changelog.html">Changelog</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="license.html">License</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Overview.html">Overview</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NFCPassportReader.html">NFCPassportReader</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/NFCPassportModel.html">NFCPassportModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/APDUResponse.html">APDUResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/TagReader.html">TagReader</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Data%20Models.html">Data Models</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DocumentDetails.html">DocumentDetails</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/FaceBiometricDataEncoding.html">FaceBiometricDataEncoding</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MRZ.html">MRZ</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PersonalDetails.html">PersonalDetails</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/TDType.html">TDType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TravelDocument.html">TravelDocument</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Cryptography.html">Cryptography</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/EncryptionAlgorithm.html">EncryptionAlgorithm</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/EncryptionAlgorithmParams.html">EncryptionAlgorithmParams</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/HashAlgorithm.html">HashAlgorithm</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/KeyAgreementAlgorithm.html">KeyAgreementAlgorithm</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/StandardizedDomainParameters.html">StandardizedDomainParameters</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/StandardizedDomainParametersType.html">StandardizedDomainParametersType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Security%20Core.html">Security Core</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ObjectIdentifier.html">ObjectIdentifier</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SubjectPublicKeyInfo.html">SubjectPublicKeyInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SecurityInfo.html">SecurityInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SecurityInfoDecoder.html">SecurityInfoDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SecurityObjectIdentifiers.html">SecurityObjectIdentifiers</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/SecurityProtocol.html">SecurityProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="IC%20Access.html">IC Access</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/BACHandler.html">BACHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DocumentBasicAccessKeys.html">DocumentBasicAccessKeys</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PACEHandler.html">PACEHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PACEInfo.html">PACEInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PACEMapping.html">PACEMapping</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PACEParametersDecoder.html">PACEParametersDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PACESecurityProtocol.html">PACESecurityProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="IC%20Authentication.html">IC Authentication</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/CAPublicKeySecurityProtocol.html">CAPublicKeySecurityProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ChipAuthenticationHandler.html">ChipAuthenticationHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ChipAuthenticationInfo.html">ChipAuthenticationInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ChipAuthenticationPublicKeyInfo.html">ChipAuthenticationPublicKeyInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ChipAuthenticationSecurityProtocol.html">ChipAuthenticationSecurityProtocol</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="IC%20Data%20Authentication.html">IC Data Authentication</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PassiveAuthenticationHandler.html">PassiveAuthenticationHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/PKCS7.html">PKCS7</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SignedData.html">SignedData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/X509Certificate.html">X509Certificate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/X509CertificateDetails.html">X509CertificateDetails</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/X509CertificateDetails/CertificateEntity.html">– CertificateEntity</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Secure%20Session.html">Secure Session</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NFCSecureSession.html">NFCSecureSession</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SecureChannel.html">SecureChannel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SecureMessaging.html">SecureMessaging</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SecurityConfiguration.html">SecurityConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SessionKeyGenerator.html">SessionKeyGenerator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SessionKeyGenerator/KeyDerivationFunctionMode.html">– KeyDerivationFunctionMode</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="DataGroups.html">DataGroups</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CardAccess.html">CardAccess</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DataGroup.html">DataGroup</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/COM.html">COM</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DataGroup1.html">DataGroup1</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DataGroup2.html">DataGroup2</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DataGroup7.html">DataGroup7</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DataGroup11.html">DataGroup11</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DataGroup12.html">DataGroup12</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DataGroup14.html">DataGroup14</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SOD.html">SOD</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DGNotImplemented.html">DGNotImplemented</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DGDecoder.html">DGDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/DGTag.html">DGTag</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Errors.html">Errors</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/APDUResponseError.html">APDUResponseError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/NFCPassportReaderError.html">NFCPassportReaderError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Classes.html">Other Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/APDUResponseErrorDecoder.html">APDUResponseErrorDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/BytesRepresentationConverter.html">BytesRepresentationConverter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DataPadder.html">DataPadder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MRZKeyGenerator.html">MRZKeyGenerator</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Enums.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/AESKeySize.html">AESKeySize</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/DisplayedMessage.html">DisplayedMessage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/PassportAuthenticationStatus.html">PassportAuthenticationStatus</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Extensions.html">Other Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/%5BUInt8%5D.html">[UInt8]</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Structs.html">Other Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/APDUCommand.html">APDUCommand</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/APDUCommand/ManageSecurityEnvironment.html">– ManageSecurityEnvironment</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other%20Typealiases.html">Other Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:17NFCPassportReader20BinaryRepresentationa">BinaryRepresentation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:17NFCPassportReader4Bytea">Byte</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:17NFCPassportReader17HexRepresentationa">HexRepresentation</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other%20Typealiases.html#/s:17NFCPassportReader17HexadecimalNumbera">HexadecimalNumber</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            <h1>Secure Session</h1>
            
          </div>
        </section>

        <section class="section">
          <div class="section-content">
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:17NFCPassportReader16NFCSecureSessionC"></a>
                    <a name="//apple_ref/swift/Class/NFCSecureSession" class="dashAnchor"></a>
                    <a class="token" href="#/s:17NFCPassportReader16NFCSecureSessionC">NFCSecureSession</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A class that manages the secure session for NFC communication, including
security configuration, secure channels, and secure messaging.</p>

<p>The <code>NFCSecureSession</code> class is responsible for establishing secure communication sessions
for NFC (Near Field Communication) using <code><a href="Classes/SecurityConfiguration.html">SecurityConfiguration</a></code>, <code><a href="Classes/SecureChannel.html">SecureChannel</a></code>, and <code><a href="Classes/SecureMessaging.html">SecureMessaging</a></code>.</p>

<ul>
<li><p>Tip: It enables secure data exchange and provides methods for configuring, establishing, and clearing the secure session.</p></li>
</ul><div class="aside aside-see-also">
    <p class="aside-title">See also</p>
    <p><code><a href="Classes/SecurityConfiguration.html">SecurityConfiguration</a></code>, <code><a href="Classes/SecureChannel.html">SecureChannel</a></code>,
<code><a href="Classes/SecureMessaging.html">SecureMessaging</a></code> and <code><a href="Classes/SessionKeyGenerator.html">SessionKeyGenerator</a></code></p>

</div>

                        <a href="Classes/NFCSecureSession.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">internal</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">NFCSecureSession</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:17NFCPassportReader13SecureChannelC"></a>
                    <a name="//apple_ref/swift/Class/SecureChannel" class="dashAnchor"></a>
                    <a class="token" href="#/s:17NFCPassportReader13SecureChannelC">SecureChannel</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Represents a secure communication channel with cryptographic parameters.</p>

<p>This class defines a secure communication channel with encryption keys (KSenc, KSmac)
and a Send Sequence Counter (SSC) for secure messaging during a session. The SSC is an unsigned integer
and its bit size matches the block size of the block cipher used for secure messaging,
which is 64 bits for <code>3DES</code> and 128 bits for AES.</p>
<div class="aside aside-see-also">
    <p class="aside-title">See also</p>
    <code><a href="Classes/NFCSecureSession.html">NFCSecureSession</a></code>, <code><a href="Classes/SecurityConfiguration.html">SecurityConfiguration</a></code>,
<code><a href="Classes/SecureMessaging.html">SecureMessaging</a></code> and <code><a href="Classes/SessionKeyGenerator.html">SessionKeyGenerator</a></code>

</div>

                        <a href="Classes/SecureChannel.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">internal</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">SecureChannel</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:17NFCPassportReader15SecureMessagingC"></a>
                    <a name="//apple_ref/swift/Class/SecureMessaging" class="dashAnchor"></a>
                    <a class="token" href="#/s:17NFCPassportReader15SecureMessagingC">SecureMessaging</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A class responsible for protecting APDU commands sent and unprotecting APDU responses received
during a <code>secure session</code> in NFC communication.</p>

<p>The <code>SecureMessaging</code> class is in charge of safeguarding the confidentiality and integrity
of APDU commands and responses exchanged in a <code><a href="Classes/NFCSecureSession.html">NFCSecureSession</a></code>. It employs either 3DES or AES in
encrypt-then-authenticate mode, ensuring the data is padded, encrypted, and authenticated.</p>
<h2 id='session-initiation' class='heading'>Session Initiation</h2>

<p>Secure Messaging is initiated when a secure session is established. Session keys are derived using a
key derivation function (KDF), and the data is padded, encrypted, and authenticated in this mode.</p>
<h2 id='session-termination' class='heading'>Session Termination</h2>

<p>Secure Messaging is terminated if a Secure Messaging error occurs or a plain APDU is received.
In such cases, the stored session keys are deleted, and the terminal&rsquo;s access rights are reset.</p>
<h2 id='3des-modes-of-operation' class='heading'>3DES Modes of Operation</h2>

<ul>
<li><p>Encryption: Two-key 3DES in CBC mode with a zero IV, using padding method 2.</p></li>
<li><p>Message Authentication: Cryptographic checksums are calculated using MAC algorithm 3
with block cipher DES, zero IV, and padding method 2. The MAC length must be 8 bytes.</p></li>
<li><p>Send Sequence Counter (SSC): For Secure Messaging following Basic Access Control (BAC),
the SSC is initialized by concatenating the four least significant bytes of RND.IC and RND.IFD.
In all other cases, the SSC is initialized to zero.</p></li>
</ul>
<h2 id='aes-modes-of-operation' class='heading'>AES Modes of Operation</h2>

<ul>
<li>Encryption: AES in CBC mode with a specific IV.</li>
<li>Message Authentication: AES in CMAC mode with a MAC length of 8 bytes.</li>
<li><p>Send Sequence Counter (SSC): The SSC is initialized to zero.</p></li>
</ul><div class="aside aside-see-also">
    <p class="aside-title">See also</p>
    <p><code><a href="Classes/NFCSecureSession.html">NFCSecureSession</a></code>, <code><a href="Classes/SecurityConfiguration.html">SecurityConfiguration</a></code>
<code><a href="Classes/SecureChannel.html">SecureChannel</a></code> and <code><a href="Classes/SessionKeyGenerator.html">SessionKeyGenerator</a></code></p>

</div>

                        <a href="Classes/SecureMessaging.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">internal</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">SecureMessaging</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:17NFCPassportReader21SecurityConfigurationC"></a>
                    <a name="//apple_ref/swift/Class/SecurityConfiguration" class="dashAnchor"></a>
                    <a class="token" href="#/s:17NFCPassportReader21SecurityConfigurationC">SecurityConfiguration</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Represents a security configuration for cryptographic operations.</p>

<p>This class encapsulates a security configuration, including encryption algorithm and key derivation settings.</p>
<div class="aside aside-see-also">
    <p class="aside-title">See also</p>
    <code><a href="Classes/NFCSecureSession.html">NFCSecureSession</a></code>, <code><a href="Classes/SecureChannel.html">SecureChannel</a></code>, <code><a href="Classes/SecureMessaging.html">SecureMessaging</a></code>
<code><a href="Classes/SessionKeyGenerator.html">SessionKeyGenerator</a></code>, <code><a href="Enums/EncryptionAlgorithm.html">EncryptionAlgorithm</a></code> and<code><a href="Enums/HashAlgorithm.html">HashAlgorithm</a></code>

</div>

                        <a href="Classes/SecurityConfiguration.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">internal</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">SecurityConfiguration</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:17NFCPassportReader19SessionKeyGeneratorC"></a>
                    <a name="//apple_ref/swift/Class/SessionKeyGenerator" class="dashAnchor"></a>
                    <a class="token" href="#/s:17NFCPassportReader19SessionKeyGeneratorC">SessionKeyGenerator</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A generator for session keys using specified key derivation mechanisms.</p>

<p>The <code>SessionKeyGenerator</code> class is responsible for deriving session keys based on defined
key derivation mechanisms. These session keys are used for various purposes,
such as encryption, message authentication and security protocols.</p>
<h2 id='key-derivation-function' class='heading'>Key Derivation Function</h2>

<p>The key derivation function <code>KDF(K, c)</code> takes the shared secret value <code>K</code> and a 32-bit,
big-endian integer <code>c</code> as inputs. It produces an octet string <code>keydata</code> as output,
which is computed as <code>keydata = H(K || c)</code>. The hash function <code>H()</code> used in the key derivation
must have a bit-length greater than or equal to the derived key&rsquo;s bit-length.</p>
<div class="aside aside-note">
    <p class="aside-title">Note</p>
    The hash value is interpreted as a big-endian byte output.

</div>
<h3 id='using-3des' class='heading'>Using 3DES</h3>

<p>To derive 128-bit (112-bit excluding parity bits) 3DES keys, the SHA-1 hash function
is used, and the following additional steps must be performed:</p>

<ul>
<li>Use octets 1 to 8 of <code>keydata</code> to form <code>keydataA</code> and octets 9 to 16 to form <code>keydataB</code>.
Additional octets are not used.</li>
<li>Optionally, adjust the parity bits of <code>keydataA</code> and <code>keydataB</code> to form correct DES keys.</li>
</ul>
<h3 id='using-aes' class='heading'>Using AES</h3>

<p>To derive 128-bit AES keys, the SHA-1 hash function is used, and the following additional step must be performed:</p>

<ul>
<li>Use octets 1 to 16 of <code>keydata</code>. Additional octets are not used.</li>
</ul>

<p>For 192-bit and 256-bit AES keys, SHA-256 is used as the hash function.</p>

<p>For 192-bit AES keys, the following additional step must be performed:</p>

<ul>
<li>Use octets 1 to 24 of keydata; additional octets are not used.</li>
</ul>
<h2 id='keyderivationfunctionmode' class='heading'>KeyDerivationFunctionMode</h2>

<p>The <code>SessionKeyGenerator</code> includes an enum called <code>KeyDerivationFunctionMode</code>, which defines different modes
for deriving session keys. Each mode corresponds to a specific use case:</p>

<ul>
<li><code>ENC_MODE</code>: For deriving session keys used in encryption.</li>
<li><code>MAC_MODE</code>: For deriving session keys used in message authentication.</li>
<li><p><code>PACE_MODE</code>: For deriving session keys used in the PACE protocol.</p></li>
</ul><div class="aside aside-see-also">
    <p class="aside-title">See also</p>
    <p><code><a href="Classes/NFCSecureSession.html">NFCSecureSession</a></code>, <code><a href="Classes/SecurityConfiguration.html">SecurityConfiguration</a></code>
<code><a href="Classes/SecureChannel.html">SecureChannel</a></code> and <code><a href="Classes/SecureMessaging.html">SecureMessaging</a></code></p>

</div>

                        <a href="Classes/SessionKeyGenerator.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">internal</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">SessionKeyGenerator</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </section>

      </article>
    </div>
    <section class="footer">
      <p>&copy; 2023 <a class="link" href="https://github.com/andrea-deluca" target="_blank" rel="external noopener">Andrea Deluca</a>. All rights reserved. (Last updated: 2023-11-20)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external noopener">jazzy ♪♫ v0.14.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external noopener">Realm</a> project.</p>
    </section>
  </body>
</html>
